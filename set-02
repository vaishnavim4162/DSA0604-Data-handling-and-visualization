# Install and load necessary libraries
if(!require(ggplot2)) install.packages("ggplot2")
if(!require(wordcloud)) install.packages("wordcloud")
if(!require(RColorBrewer)) install.packages("RColorBrewer")

library(ggplot2)
library(wordcloud)
library(RColorBrewer)

# Step 1: Create the dataset
customer_data <- data.frame(
  CustomerID = c(1, 2, 3, 4, 5),
  Age = c(25, 30, 35, 28, 40),
  SatisfactionScore = c(4, 5, 3, 4, 5)
)

# Step 2: Histogram of customer ages
histogram_age <- ggplot(customer_data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Customer Ages",
       x = "Age",
       y = "Frequency") +
  theme_minimal()
print(histogram_age)

# Step 3: Pie chart for satisfaction score distribution
score_counts <- table(customer_data$SatisfactionScore)
pie_labels <- paste(names(score_counts), " (", score_counts, ")", sep = "")
pie(score_counts,
    labels = pie_labels,
    main = "Customer Satisfaction Score Distribution",
    col = brewer.pal(length(score_counts), "Pastel1"))

# Step 4: Stacked bar chart for satisfaction score by age group
# Create Age Groups
customer_data$AgeGroup <- cut(customer_data$Age,
                              breaks = c(20, 30, 40, 50),
                              labels = c("20-30", "30-40", "40-50"))
stacked_bar <- ggplot(customer_data, aes(x = AgeGroup, fill = factor(SatisfactionScore))) +
  geom_bar() +
  labs(title = "Satisfaction Score by Age Group",
       x = "Age Group",
       y = "Count",
       fill = "Satisfaction Score") +
  theme_minimal()
print(stacked_bar)

# Step 5: Word Cloud from sample feedback text
# Sample feedback (you can replace with actual text data)
feedback <- c("Great service", "Very satisfied", "Average experience", "Excellent product", "Loved it")
wordcloud(feedback,
          scale = c(3, 0.5),
          max.words = 50,
          random.order = FALSE,
          colors = brewer.pal(8, "Dark2"))

# Step 6: Export dataset for Tableau dashboard
write.csv(customer_data, "customer_feedback.csv", row.names = FALSE)
